# 2. ユーザー管理

ユーザーの権限管理は、原則として管理画面から行います。

## 管理者権限の付与・剥奪

管理者権限の付与および剥奪は、`/admin/users` ページのユーザー一覧から対象ユーザーを選択し、実行します。

### 注意事項
- **最後の管理者権限は剥奪できません**
  - アプリケーションに管理者が最低1人存在することを保証するため、残り1人の管理者となっているユーザーの権限を剥奪することはできません。別のユーザーに管理者権限を付与した後であれば、操作は可能になります。

## 緊急時の手動による権限付与

何らかの理由で管理画面にアクセスできなくなった場合など、緊急時にはSupabase経由で手動で管理者権限を付与することも可能です。

### 手順

1.  **Supabaseプロジェクト > SQL Editor** に移動します。
2.  「New query」を作成し、以下のSQLを実行します。
3.  `'【対象のメールアドレス】'` の部分を、権限を付与したいユーザーのメールアドレスに書き換えてください。

```sql
UPDATE auth.users
SET raw_app_meta_data = raw_app_meta_data || '{"claims_admin": true}'
WHERE email = '【対象のメールアドレス】';
```

実行後、対象ユーザーは一度ログアウトし、再ログインすることで管理者権限が有効になります。